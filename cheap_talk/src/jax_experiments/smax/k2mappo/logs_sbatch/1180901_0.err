/home/reddi/miniconda3/envs/cheap/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: aryaman-reddi (tu-darmstadt-literl) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: aryaman-reddi (tu-darmstadt-literl) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: aryaman-reddi (tu-darmstadt-literl) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: aryaman-reddi (tu-darmstadt-literl) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.9
wandb: Run data is saved locally in /home/reddi/project-cheap/cheap-talk/cheap_talk/src/jax_experiments/smax/k2mappo/wandb/run-20250502_144220-7d02uqrh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 0_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/tu-darmstadt-literl/smax
wandb: üöÄ View run at https://wandb.ai/tu-darmstadt-literl/smax/runs/7d02uqrh
wandb: creating run
wandb: creating run
wandb: Tracking run with wandb version 0.19.9
wandb: Run data is saved locally in /home/reddi/project-cheap/cheap-talk/cheap_talk/src/jax_experiments/smax/k2mappo/wandb/run-20250502_144221-epw3ul37
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 0_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/tu-darmstadt-literl/smax
wandb: üöÄ View run at https://wandb.ai/tu-darmstadt-literl/smax/runs/epw3ul37
wandb: Tracking run with wandb version 0.19.9
wandb: Run data is saved locally in /home/reddi/project-cheap/cheap-talk/cheap_talk/src/jax_experiments/smax/k2mappo/wandb/run-20250502_144220-kh9s7qhg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 0_0
wandb: ‚≠êÔ∏è View project at https://wandb.ai/tu-darmstadt-literl/smax
wandb: üöÄ View run at https://wandb.ai/tu-darmstadt-literl/smax/runs/kh9s7qhg
wandb: Tracking run with wandb version 0.19.9
wandb: Run data is saved locally in /home/reddi/project-cheap/cheap-talk/cheap_talk/src/jax_experiments/smax/k2mappo/wandb/run-20250502_144220-kvzfwh4b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 0_1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/tu-darmstadt-literl/smax
wandb: üöÄ View run at https://wandb.ai/tu-darmstadt-literl/smax/runs/kvzfwh4b
2025-05-02 14:42:43.944857: W external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1120] Compiling 1560 configs for 48 fusions on a single thread.
2025-05-02 14:58:14.128107: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 15.78GiB (16941158597 bytes) by rematerialization; only reduced to 21.10GiB (22659476456 bytes), down from 21.26GiB (22828828936 bytes) originally
2025-05-02 14:59:17.380276: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 21.76GiB (rounded to 23366181632)requested by op 
2025-05-02 14:59:17.381269: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *___________________________________________________________________________________________________
E0502 14:59:17.381812 3422149 pjrt_stream_executor_client.cc:2839] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 23366181576 bytes. [tf-allocator-allocation-error='']
wandb:                                                                                
wandb:                                                                                
wandb:                                                                                
wandb: üöÄ View run 0_1 at: https://wandb.ai/tu-darmstadt-literl/smax/runs/kvzfwh4b
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/tu-darmstadt-literl/smax
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: üöÄ View run 0_0 at: https://wandb.ai/tu-darmstadt-literl/smax/runs/kh9s7qhg
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/tu-darmstadt-literl/smax
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: üöÄ View run 0_2 at: https://wandb.ai/tu-darmstadt-literl/smax/runs/7d02uqrh
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/tu-darmstadt-literl/smax
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250502_144220-kvzfwh4b/logs
wandb: Find logs at: ./wandb/run-20250502_144220-7d02uqrh/logs
wandb: Find logs at: ./wandb/run-20250502_144220-kh9s7qhg/logs
wandb:                                                                                
wandb: üöÄ View run 0_3 at: https://wandb.ai/tu-darmstadt-literl/smax/runs/epw3ul37
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/tu-darmstadt-literl/smax
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250502_144221-epw3ul37/logs
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/reddi/project-cheap/cheap-talk/cheap_talk/src/jax_experiments/smax/k2mappo/k2mappo_rnn_smax.py", line 1382, in main
    out = jax.vmap(train_jit)(rng_seeds, exp_ids)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 23366181576 bytes.
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
